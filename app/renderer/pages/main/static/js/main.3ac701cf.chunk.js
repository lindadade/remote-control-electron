(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[0],{0:function(e,n){e.exports=require("electron")},13:function(e,n,t){},15:function(e,n,t){},16:function(e,n,t){"use strict";t.r(n);var r=t(1),c=t(3),a=t.n(c),i=t(7),o=t.n(i),s=(t(13),t(2)),u=t.n(s),d=t(4),p=t(5),f=(t(15),t(0));function l(){return h.apply(this,arguments)}function h(){return(h=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.desktopCapturer.getSources({types:["screen"]});case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,t){navigator.webkitGetUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n[0].id,maxWidth:window.screen.width,maxHeight:window.screen.height}}},(function(n){e(n)}),(function(e){console.log(e)}))})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=new window.RTCPeerConnection({});w.ondatachannel=function(e){console.log("datachannel",e),e.channel.onmessage=function(e){var n=JSON.parse(e.data),t=n.type,r=n.data;"mouse"===t&&(r.screen={width:window.screen.width,height:window.screen.height}),f.ipcRenderer.send("robot",t,r)}},w.onicecandidate=function(e){console.log("candidate",JSON.stringify(e.candidate)),e.candidate&&f.ipcRenderer.send("forward","puppet-candidate",JSON.stringify(e.candidate))},f.ipcRenderer.on("candidate",(function(e,n){v(n)}));var b=[];function v(e){return j.apply(this,arguments)}function j(){return(j=Object(d.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&b.push(n),!(null===(t=w.remoteDescription)||void 0===t?void 0:t.type)){e.next=10;break}r=0;case 3:if(!(r<b.length)){e.next=9;break}return e.next=6,w.addIceCandidate(new RTCIceCandidate(b[r]));case 6:r++,e.next=3;break;case 9:b=[];case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return g.apply(this,arguments)}function g(){return(g=Object(d.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:return t=e.sent,w.addStream(t),e.next=6,w.setRemoteDescription(n);case 6:return e.t0=w,e.next=9,w.createAnswer();case 9:return e.t1=e.sent,e.next=12,e.t0.setLocalDescription.call(e.t0,e.t1);case 12:return console.log("answer",JSON.stringify(w.localDescription)),e.abrupt("return",w.localDescription);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.addIceCandidate=v,f.ipcRenderer.on("offer",function(){var e=Object(d.a)(u.a.mark((function e(n,t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:r=e.sent,f.ipcRenderer.send("forward","answer",{type:r.type,sdp:r.sdp});case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),window.createAnswer=x;var m=function(){var e=Object(c.useState)(""),n=Object(p.a)(e,2),t=n[0],a=n[1],i=Object(c.useState)(""),o=Object(p.a)(i,2),s=o[0],l=o[1],h=Object(c.useState)(""),w=Object(p.a)(h,2),b=w[0],v=w[1],j=function(){var e=Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.ipcRenderer.invoke("login");case 2:n=e.sent,l(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(e,n,t){var r="";r=1===t?"\u6b63\u5728\u8fdc\u7a0b\u63a7\u5236".concat(n):2===t?"\u88ab".concat(n,"\u63a7\u5236\u4e2d"):"",v(r)};return Object(c.useEffect)((function(){return j(),f.ipcRenderer.on("control-state-change",x),function(){f.ipcRenderer.removeListener("control-state-change",x)}}),[]),Object(r.jsx)("div",{className:"App",children:""===b?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{children:["\u4f60\u7684\u63a7\u5236\u7801 ",Object(r.jsxs)("span",{onContextMenu:function(e){return function(e){e.preventDefault();var n=f.remote.Menu,t=f.remote.MenuItem,r=new n;r.append(new t({label:"\u590d\u5236",role:"copy"})),r.append(new t({label:"\u5206\u4eab\u5230\u5fae\u4fe1",click:function(e,n,t){f.ipcRenderer.send("share-to-wechat",s)}})),r.popup()}(e)},children:[" ",s," (\u5206\u4eab/\u590d\u5236) "]})]}),Object(r.jsx)("input",{type:"text",value:t,onChange:function(e){return a(e.target.value)}}),Object(r.jsx)("button",{onClick:function(){!function(e){f.ipcRenderer.send("control",e)}(t)},children:"\u786e\u8ba4"})]}):Object(r.jsx)("div",{children:b})})},O=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,17)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,a=n.getLCP,i=n.getTTFB;t(e),r(e),c(e),a(e),i(e)}))};o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(m,{})}),document.getElementById("root")),O()}},[[16,1,2]]]);
//# sourceMappingURL=main.3ac701cf.chunk.js.map